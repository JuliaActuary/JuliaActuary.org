<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <meta name=Description  content="Practical, extensible, and open-source actuarial modeling and analysis."> <meta property="og:description" content="Practical, extensible, and open-source actuarial modeling and analysis."> <meta property="og:image" content="/assets/logo_square.svg"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="/assets/favicon.png"> <script async defer src="https://buttons.github.io/buttons.js"></script> <title>Benchmarks | JuliaActuary</title> <link rel=apple-touch-icon  sizes=180x180  href="/assets/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="/assets/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="/assets/favicon-16x16.png"> <link rel=manifest  href="/assets/site.webmanifest"> <header> <div class=blog-name > <a href="/"> <div class=blog-name-logo-container > <div class=blog-name-logo > <img src="/assets/logo_square.svg" alt=logo  /> </div> <div>JuliaActuary</div> </div> </a> <div class=tagline >Practical, extensible, and open-source actuarial modeling and analysis. </div> </div> <nav> <ul> <li><a href="/">Home</a> <li><a href="/#packages">Packages</a> <ul> <li><a href="/#mortalitytablesjl">MortalityTables.jl</a> <li><a href="/#actuaryutilitiesjl">ActuaryUtilities.jl</a> <li><a href="/#lifecontingenciesjl">LifeContingencies.jl</a> <li><a href="/#yieldsjl">Yields.jl</a> <li><a href="/#experienceanalysisjl">ExperienceAnalysis.jl</a> </ul> <li><a href="/#community">Community</a> <ul> <li><a href="/#learn">Learn</a> <li><a href="/#integration_with_r_and_python">Integration</a> <li><a href="/#contributing">Contributing</a> </ul> <li><a href="/#blog">Blog</a> </ul> <img src="/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=fill_title ><a href="#fill_title" class=header-anchor >Benchmarks</a></h1> <div class=franklin-toc ><ol><li><a href="#the_life_modeling_problem">The Life Modeling Problem</a><ol><li><a href="#benchmarks">Benchmarks</a><li><a href="#discussion">Discussion</a></ol><li><a href="#irrs">IRRs</a><ol><li><a href="#benchmarks__2">Benchmarks</a><li><a href="#discussion__2">Discussion</a></ol><li><a href="#other_benchmarks">Other benchmarks</a><li><a href="#colophone">Colophone</a><ol><li><a href="#code">Code</a><li><a href="#hardware">Hardware</a><li><a href="#software">Software</a><ol><li><a href="#julia">Julia</a><li><a href="#rust">Rust</a><li><a href="#python">Python</a><li><a href="#r">R</a></ol></ol><li><a href="#footnotes">Footnotes</a></ol></div> <h2 id=the_life_modeling_problem ><a href="#the_life_modeling_problem" class=header-anchor >The Life Modeling Problem</a></h2> <p>Inspired by the discussion in the <a href="https://github.com/actuarialopensource">ActuarialOpenSource</a> GitHub community discussion, folks started submitted solutions to what someone referred to as the &quot;Life Modeling Problem&quot;. This user <a href="https://github.com/orgs/actuarialopensource/teams/common-room/discussions/5">submitted a short snippet</a> for consideraton of a representative problem.</p> <h3 id=benchmarks ><a href="#benchmarks" class=header-anchor >Benchmarks</a></h3> <p>After the orignal user submitted a proposal, others chimed in and submitted versions in their favorite languages. I have collected those versions, and run them on a consistent set of hardware.</p> <p>Some submissions were excluded becuase from the benchmarks they involved an entirely different approach, such as <a href="https://en.wikipedia.org/wiki/Memoization">memoizing</a> the function calls<sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup>.</p> <pre><code class=language-julia >Times are nanoseconds:
┌────────────────┬─────────────┬───────────────┬──────────┬──────────┐
│           lang │   algorithm │ function_name │   median │     mean │
│         String │      String │        String │ Float64? │ Float64? │
├────────────────┼─────────────┼───────────────┼──────────┼──────────┤
│ R &#40;data.table&#41; │  Vectorized │           npv │ 770554.0 │ 842767.3 │
│              R │  Vectorized │      npv base │   4264.0 │  46617.0 │
│              R │ Accumulator │      npv_loop │   4346.0 │  62275.7 │
│           Rust │ Accumulator │           npv │     24.0 │  missing │
│ Python &#40;NumPy&#41; │  Vectorized │           npv │  missing │   6823.3 │
│         Python │ Accumulator │      npv_loop │  missing │   1486.0 │
│          Julia │  Vectorized │          npv1 │    235.3 │    228.2 │
│          Julia │  Vectorized │          npv2 │    235.8 │    218.4 │
│          Julia │ Accumulator │          npv3 │     14.5 │     14.5 │
│          Julia │ Accumulator │          npv4 │     10.8 │     10.8 │
│          Julia │ Accumulator │          npv5 │     11.5 │     11.5 │
│          Julia │ Accumulator │          npv6 │      9.0 │      9.0 │
│          Julia │ Accumulator │          npv7 │      7.9 │      7.9 │
│          Julia │ Accumulator │          npv8 │      7.4 │      7.4 │
│          Julia │ Accumulator │          npv9 │      6.4 │      6.4 │
└────────────────┴─────────────┴───────────────┴──────────┴──────────┘</code></pre> <p>To aid in visualizing results with such vast different orders of magnitude, this graph includes a physical length comparsion to serve as a reference. The computation time is represented by the distance that light travels in the time for the computation to complete &#40;comparing a nanosecond to one foot length <a href="https://www.youtube.com/watch?v&#61;9eyFDBPk4Yw">goes at least back to Admiral Grace Hopper</a>&#41;. <img src="/blog/data/benchmarks.svg" alt="Life Modeling Problem Benchmarks" /></p> <h3 id=discussion ><a href="#discussion" class=header-anchor >Discussion</a></h3> <p>For more a more in-depth discussion of these results, see <a href="/blog/life-modeling-problem/">this post</a>.</p> <p>All of the benchmarked code can be found in the <a href="https://github.com/JuliaActuary/Learn/tree/master/Benchmarks/LifeModelingProblem">JuliaActuary Learn repository</a>. Please file an issue or submit a PR request there for issues/suggestions.</p> <h2 id=irrs ><a href="#irrs" class=header-anchor >IRRs</a></h2> <p>Task: determine the IRR for a series of cashflows 701 elements long.</p> <h3 id=benchmarks__2 ><a href="#benchmarks__2" class=header-anchor >Benchmarks</a></h3> <pre><code class=language-plaintext >Times are in nanoseconds:
┌──────────┬──────────────────┬───────────────────┬─────────┬─────────────┬───────────────┐
│ Language │          Package │          Function │  Median │        Mean │ Relative Mean │
├──────────┼──────────────────┼───────────────────┼─────────┼─────────────┼───────────────┤
│   Python │  numpy_financial │               irr │ missing │ 918376814.0 │       13350.1 │
│   Python │           better │ irr_binary_search │ missing │   3698785.0 │          53.8 │
│   Python │           better │        irr_newton │ missing │    557129.0 │           8.1 │
│    Julia │ ActuaryUtilities │               irr │ 69625.0 │     68792.0 │           1.0 │
└──────────┴──────────────────┴───────────────────┴─────────┴─────────────┴───────────────┘</code></pre> <h3 id=discussion__2 ><a href="#discussion__2" class=header-anchor >Discussion</a></h3> <p>Julia is 13,350 times faster than <code>numpy_financial</code>, and 54 times faster than the <code>better</code> Python package. The <a href="/#actuaryutilitiesjl">ActuaryUtililites.jl</a> implementation is also more flexible, as it can be given an argument with timepoints, similar to Excel&#39;s <code>XIRR</code>.</p> <p>Excel was used to attempt a benchmark, but the <code>IRR</code> formula returned a <code>#DIV/0&#33;</code> error.</p> <p>All of the benchmarked code can be found in the <a href="https://github.com/JuliaActuary/Learn/tree/master/Benchmarks/irr">JuliaActuary Learn repository</a>. Please file an issue or submit a PR request there for issues/suggestions.</p> <h2 id=other_benchmarks ><a href="#other_benchmarks" class=header-anchor >Other benchmarks</a></h2> <p>These benchmarks have been performed by others, but provide relevant information for actuarial-related work:</p> <ul> <li><p><a href="https://h2oai.github.io/db-benchmark/">H2Oai DataFrames/Database-like Operations</a></p> <li><p><a href="https://juliacomputing.com/blog/2020/06/fast-csv/">Reading CSVs</a></p> </ul> <h2 id=colophone ><a href="#colophone" class=header-anchor >Colophone</a></h2> <h3 id=code ><a href="#code" class=header-anchor >Code</a></h3> <p>All of the benchmarked code can be found in the <a href="https://github.com/JuliaActuary/Learn/tree/master/Benchmarks/">JuliaActuary Learn repository</a>. Please file an issue or submit a PR request there for issues/suggestions.</p> <h3 id=hardware ><a href="#hardware" class=header-anchor >Hardware</a></h3> <p>Macbook Air &#40;M1, 2020&#41;</p> <h3 id=software ><a href="#software" class=header-anchor >Software</a></h3> <p>All languages/libraries are Mac M1 native unless otherwise noted</p> <h4 id=julia ><a href="#julia" class=header-anchor >Julia</a></h4> <pre><code class=language-julia >Julia Version 1.7.0-DEV.938
Commit 2b4c088ee7* &#40;2021-04-16 20:37 UTC&#41;
Platform Info:
  OS: macOS &#40;arm64-apple-darwin20.3.0&#41;
  CPU: Apple M1
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-11.0.1 &#40;ORCJIT, cyclone&#41;</code></pre> <h4 id=rust ><a href="#rust" class=header-anchor >Rust</a></h4> <pre><code class=language-julia >1.53.0-nightly &#40;b0c818c5e 2021-04-16&#41;</code></pre>
<h4 id=python ><a href="#python" class=header-anchor >Python</a></h4>
<pre><code class=language-julia >Python 3.9.4 &#40;default, Apr  4 2021, 17:42:23&#41; 
&#91;Clang 12.0.0 &#40;clang-1200.0.32.29&#41;&#93; on darwin</code></pre>
<h4 id=r ><a href="#r" class=header-anchor >R</a></h4>
<pre><code class=language-julia >R Under development &#40;unstable&#41; &#40;2021-04-16 r80179&#41; -- &quot;Unsuffered Consequences&quot;
Copyright &#40;C&#41; 2021 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20.0 &#40;64-bit&#41;</code></pre>
<h2 id=footnotes ><a href="#footnotes" class=header-anchor >Footnotes</a></h2>
<p><sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup> If benchmarking memoiziation, it&#39;s essentially benchmarking how long it takes to perform hashing in a language. While interesting, especially in the context of <a href="https://scattered-thoughts.net/writing/an-opinionated-map-of-incremental-and-streaming-systems">incremental computing</a>, it&#39;s not the core issue at hand. Incremental computing libraries exist for all of the modern languages discussed here.</p>
<p><sup id="fnref:2"><a href="#fndef:2" class=fnref >[2]</a></sup> Note that not all languages have both a mean and median result in their benchmarking libraries. Mean is a better representation for a garbage-collected modern language, because sometimes the computation just takes longer than the median result. Where the mean is not avaiable in the graph below, median is substituted.</p>
<div class=page-foot >
  <div class=copyright >
    &copy; Misc. Last modified: August 15, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and <a href="https://julialang.org" >Julia</a>.
  </div>
</div>
</div>
    
    
        <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

    
    <script data-goatcounter="https://juliaactuary.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>