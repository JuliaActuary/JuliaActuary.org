<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <meta name=Description  content="Practical, extensible, and open-source actuarial modeling and analysis."> <meta property="og:description" content="Practical, extensible, and open-source actuarial modeling and analysis."> <meta property="og:image" content="/assets/logo_square.svg"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="/assets/favicon.png"> <title>Benchmarks | JuliaActuary</title> <link rel=apple-touch-icon  sizes=180x180  href="/assets/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="/assets/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="/assets/favicon-16x16.png"> <link rel=manifest  href="/assets/site.webmanifest"> <script src="https://cdn.jsdelivr.net/npm/swiffy-slider@1.2.0/dist/js/swiffy-slider.min.js" crossorigin=anonymous  defer></script> <link href="/css/slider.css" rel=stylesheet > <header> <div class=blog-name > <a href="/"> <div class=blog-name-logo-container > <div class=blog-name-logo > <img src="/assets/logo_square.svg" alt=logo  height=100px  width=100px  /> </div> <div>JuliaActuary</div> </div> </a> <div class=tagline >Practical, extensible, and open-source actuarial modeling and analysis. </div> </div> <nav> <ul> <li><a href="/">Home</a> <li><a href="/packages">Packages</a> <ul> <li><a href="/packages/#mortalitytablesjl">MortalityTables.jl</a> <li><a href="/packages/#actuaryutilitiesjl">ActuaryUtilities.jl</a> <li><a href="/packages/#lifecontingenciesjl">LifeContingencies.jl</a> <li><a href="/packages/#yieldsjl">Yields.jl</a> <li><a href="/packages/#experienceanalysisjl">ExperienceAnalysis.jl</a> </ul> <li><a href="/community">Community</a> <ul> <li><a href="/community/#learn">Learn</a> <li><a href="/community/#integration_with_r_and_python">Integration</a> <li><a href="/community/#contributing">Contributing</a> </ul> <li><a href="/#blog">Blog</a> </ul> <img src="/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=fill_title ><a href="#fill_title" class=header-anchor >Benchmarks</a></h1> <div class=franklin-toc ><ol><li><a href="#the_life_modeling_problem">The Life Modeling Problem</a><ol><li><a href="#benchmarks">Benchmarks</a><li><a href="#discussion">Discussion</a></ol><li><a href="#irrs">IRRs</a><ol><li><a href="#benchmarks__2">Benchmarks</a><li><a href="#discussion__2">Discussion</a></ol><li><a href="#black-scholes-merton_european_option_pricing">Black-Scholes-Merton European Option Pricing</a><ol><li><a href="#benchmarks__3">Benchmarks</a><li><a href="#discussion__3">Discussion</a></ol><li><a href="#other_benchmarks">Other benchmarks</a><li><a href="#colophone">Colophone</a><ol><li><a href="#code">Code</a><li><a href="#hardware">Hardware</a><li><a href="#software">Software</a><ol><li><a href="#julia">Julia</a><li><a href="#rust">Rust</a><li><a href="#python">Python</a><li><a href="#r">R</a></ol></ol><li><a href="#footnotes">Footnotes</a></ol></div> <h2 id=the_life_modeling_problem ><a href="#the_life_modeling_problem" class=header-anchor >The Life Modeling Problem</a></h2> <p>Inspired by the discussion in the <a href="https://github.com/actuarialopensource">ActuarialOpenSource</a> GitHub community discussion, folks started submitted solutions to what someone referred to as the &quot;Life Modeling Problem&quot;. This user <a href="https://github.com/orgs/actuarialopensource/teams/common-room/discussions/5">submitted a short snippet</a> for consideration of a representative problem.</p> <h3 id=benchmarks ><a href="#benchmarks" class=header-anchor >Benchmarks</a></h3> <p>After the original user submitted a proposal, others chimed in and submitted versions in their favorite languages. I have collected those versions, and run them on a consistent set of hardware.</p> <p>Some submissions were excluded because from the benchmarks they involved an entirely different approach, such as <a href="https://en.wikipedia.org/wiki/Memoization">memoizing</a> the function calls<sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup>.</p> <pre><code class="plaintext code-output">┌────────────────┬─────────────┬───────────────┬───────────────┬───────────────┐
│       Language │   Algorithm │ Function name │        Median │          Mean │
│                │             │               │ [nanoseconds] │ [nanoseconds] │
├────────────────┼─────────────┼───────────────┼───────────────┼───────────────┤
│ R (data.table) │  Vectorized │           npv │       770,554 │       842,767 │
│              R │  Vectorized │      npv base │         4,264 │        46,617 │
│              R │ Accumulator │      npv_loop │         4,346 │        62,276 │
│           Rust │ Accumulator │          npv1 │            22 │            22 │
│           Rust │ Accumulator │          npv2 │            14 │            14 │
│           Rust │ Accumulator │          npv3 │             7 │             7 │
│ Python (NumPy) │  Vectorized │           npv │       missing │        14,261 │
│         Python │ Accumulator │      npv_loop │       missing │         2,314 │
│ Python (Numba) │ Accumulator │     npv_numba │       missing │           626 │
│          Julia │  Vectorized │          npv1 │           235 │           228 │
│          Julia │  Vectorized │          npv2 │           236 │           218 │
│          Julia │ Accumulator │          npv3 │            15 │            14 │
│          Julia │ Accumulator │          npv4 │            11 │            11 │
│          Julia │ Accumulator │          npv5 │            11 │            11 │
│          Julia │ Accumulator │          npv6 │             9 │             9 │
│          Julia │ Accumulator │          npv7 │             8 │             8 │
│          Julia │ Accumulator │          npv8 │             7 │             7 │
│          Julia │ Accumulator │          npv9 │             6 │             6 │
└────────────────┴─────────────┴───────────────┴───────────────┴───────────────┘
</code></pre> <p>To aid in visualizing results with such vast different orders of magnitude, this graph includes a physical length comparison to serve as a reference. The computation time is represented by the distance that light travels in the time for the computation to complete &#40;comparing a nanosecond to one foot length <a href="https://www.youtube.com/watch?v&#61;9eyFDBPk4Yw">goes at least back to Admiral Grace Hopper</a>&#41;.</p> <img src="/assets/benchmarks/code/output/lmp_benchmarks.svg" alt=""> <h3 id=discussion ><a href="#discussion" class=header-anchor >Discussion</a></h3> <p>For more a more in-depth discussion of these results, see <a href="/blog/life-modeling-problem/">this post</a>.</p> <p>All of the benchmarked code can be found in the <a href="https://github.com/JuliaActuary/Learn/tree/master/Benchmarks/LifeModelingProblem">JuliaActuary Learn repository</a>. Please file an issue or submit a PR request there for issues/suggestions.</p> <h2 id=irrs ><a href="#irrs" class=header-anchor >IRRs</a></h2> <p><strong>Task:</strong> determine the IRR for a series of cashflows 701 elements long.</p> <h3 id=benchmarks__2 ><a href="#benchmarks__2" class=header-anchor >Benchmarks</a></h3> <pre><code class=language-plaintext >Times are in nanoseconds:
┌──────────┬──────────────────┬───────────────────┬─────────┬─────────────┬───────────────┐
│ Language │          Package │          Function │  Median │        Mean │ Relative Mean │
├──────────┼──────────────────┼───────────────────┼─────────┼─────────────┼───────────────┤
│   Python │  numpy_financial │               irr │ missing │ 918376814.0 │       13350.1 │
│   Python │           better │ irr_binary_search │ missing │   3698785.0 │          53.8 │
│   Python │           better │        irr_newton │ missing │    557129.0 │           8.1 │
│    Julia │ ActuaryUtilities │               irr │ 69625.0 │     68792.0 │           1.0 │
└──────────┴──────────────────┴───────────────────┴─────────┴─────────────┴───────────────┘</code></pre> <h3 id=discussion__2 ><a href="#discussion__2" class=header-anchor >Discussion</a></h3> <p>Julia is 13,350 times faster than <code>numpy_financial</code>, and 54 times faster than the <code>better</code> Python package. The <a href="/#actuaryutilitiesjl">ActuaryUtililites.jl</a> implementation is also more flexible, as it can be given an argument with timepoints, similar to Excel&#39;s <code>XIRR</code>.</p> <p>Excel was used to attempt a benchmark, but the <code>IRR</code> formula returned a <code>#DIV/0&#33;</code> error.</p> <p>All of the benchmarked code can be found in the <a href="https://github.com/JuliaActuary/Learn/tree/master/Benchmarks/irr">JuliaActuary Learn repository</a>. Please file an issue or submit a PR request there for issues/suggestions.</p> <h2 id=black-scholes-merton_european_option_pricing ><a href="#black-scholes-merton_european_option_pricing" class=header-anchor >Black-Scholes-Merton European Option Pricing</a></h2> <p><strong>Task:</strong> calculate the price of a vanilla european call option using the Black-Scholes-Merton formula.</p> \[\begin{aligned} C(S_t, t) &= N(d_1)S_t - N(d_2)Ke^{-r(T - t)} \\ d_1 &= \frac{1}{\sigma\sqrt{T - t}}\left[\ln\left(\frac{S_t}{K}\right) + \left(r + \frac{\sigma^2}{2}\right)(T - t)\right] \\ d_2 &= d_1 - \sigma\sqrt{T - t} \end{aligned}\] <h3 id=benchmarks__3 ><a href="#benchmarks__3" class=header-anchor >Benchmarks</a></h3> <pre><code class=language-plaintext >Times are in nanoseconds:
┌──────────┬─────────┬─────────────┬───────────────┐
│ Language │  Median │        Mean │ Relative Mean │
├──────────┼─────────┼─────────────┼───────────────┤
│   Python │ missing │    817000.0 │       19926.0 │
│        R │  3649.0 │      3855.2 │          92.7 │
│    Julia │    41.0 │        41.6 │           1.0 │
└──────────┴─────────┴─────────────┴───────────────┘</code></pre> <h3 id=discussion__3 ><a href="#discussion__3" class=header-anchor >Discussion</a></h3> <p>Julia is nearly 20,000 times faster than Python, and two orders of magnitude faster than R.</p> <h2 id=other_benchmarks ><a href="#other_benchmarks" class=header-anchor >Other benchmarks</a></h2> <p>These benchmarks have been performed by others, but provide relevant information for actuarial-related work:</p> <ul> <li><p><a href="https://h2oai.github.io/db-benchmark/">H2Oai DataFrames/Database-like Operations</a></p> <li><p><a href="https://juliacomputing.com/blog/2020/06/fast-csv/">Reading CSVs</a></p> </ul> <h2 id=colophone ><a href="#colophone" class=header-anchor >Colophone</a></h2> <h3 id=code ><a href="#code" class=header-anchor >Code</a></h3> <p>All of the benchmarked code can be found in the <a href="https://github.com/JuliaActuary/Learn/tree/master/Benchmarks/">JuliaActuary Learn repository</a>. Please file an issue or submit a PR request there for issues/suggestions.</p> <h3 id=hardware ><a href="#hardware" class=header-anchor >Hardware</a></h3> <p>Macbook Air &#40;M1, 2020&#41;</p> <h3 id=software ><a href="#software" class=header-anchor >Software</a></h3> <p>All languages/libraries are Mac M1 native unless otherwise noted</p> <h4 id=julia ><a href="#julia" class=header-anchor >Julia</a></h4> <pre><code class=language-julia >Julia Version 1.7.0-DEV.938
Commit 2b4c088ee7* &#40;2021-04-16 20:37 UTC&#41;
Platform Info:
  OS: macOS &#40;arm64-apple-darwin20.3.0&#41;
  CPU: Apple M1
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-11.0.1 &#40;ORCJIT, cyclone&#41;</code></pre> <h4 id=rust ><a href="#rust" class=header-anchor >Rust</a></h4> <pre><code class=language-julia >1.61.0-nightly &#40;f103b2969 2022-03-12&#41;</code></pre>
<h4 id=python ><a href="#python" class=header-anchor >Python</a></h4>
<pre><code class=language-julia >Python 3.9.7

numba                     0.54.1           py39hae1ba45_0
numpy                     1.20.3           py39h4b4dc7a_0</code></pre>
<h4 id=r ><a href="#r" class=header-anchor >R</a></h4>
<pre><code class=language-julia >R Under development &#40;unstable&#41; &#40;2021-04-16 r80179&#41; -- &quot;Unsuffered Consequences&quot;
Copyright &#40;C&#41; 2021 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20.0 &#40;64-bit&#41;</code></pre>
<h2 id=footnotes ><a href="#footnotes" class=header-anchor >Footnotes</a></h2>
<p><sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup> If benchmarking memoiziation, it&#39;s essentially benchmarking how long it takes to perform hashing in a language. While interesting, especially in the context of <a href="https://scattered-thoughts.net/writing/an-opinionated-map-of-incremental-and-streaming-systems">incremental computing</a>, it&#39;s not the core issue at hand. Incremental computing libraries exist for all of the modern languages discussed here.</p>
<p><sup id="fnref:2"><a href="#fndef:2" class=fnref >[2]</a></sup> Note that not all languages have both a mean and median result in their benchmarking libraries. Mean is a better representation for a garbage-collected modern language, because sometimes the computation just takes longer than the median result. Where the mean is not available in the graph below, median is substituted.</p>
<div class=page-foot >
  The packages in JuliaActuary are open-source and liberally licensed (MIT License) to allow wide private and commercial
  usage of the packages, like the base Julia language and many other packages in the ecosystem.
  
  
  <div class=copyright >
    &copy; Misc. Last modified: March 20, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and <a href="https://julialang.org">Julia</a>.
  </div>
</div></div>
    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
        <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

    
    <script data-goatcounter="https://juliaactuary.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>